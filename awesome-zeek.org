#+TITLE: Awesome Zeek
#+AUTHOR: GTrunSec
#+EMAIL: gtrunsec@hardenedlinux.org
#+DATE: 20 September 2020
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en cn
#+SETUPFILE: ./hugo.setup
#+SETUPFILE: ~/Documents/my-blog/public/theme/org-html-themes/setup/theme-readtheorg.setup
#+hugo_publishdate: (0 5)
#+hugo_auto_set_lastmod: t
#+HUGO_categories:
#+HUGO_tags:
#+OPTIONS:   H:3 num:t toc:t \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
#+PROPERTY: header-args:sh :prologue "exec 2>&1" :epilogue ":"
#+TAGS: analyzer(a) agent(A) packet(P) package(p) windows(w) linux(l)
- tags :: [[file:nsm.org][Network monitoring]]
  
- [[https://app.slack.com/client/TSXGCHZE1/CSZBXF6TH][Slack | general | Zeek | 1 new item]]
* Zeek installation
** [[https://www.ericooi.com/zeekurity-zen-part-i-how-to-install-zeek-on-centos-8/#comment-1670][Zeekurity Zen - Part I: How to Install Zeek on CentOS 8 - ericooi.com]]
*** [[https://www.ericooi.com/zeekurity-zen-zeries/][Zeekurity Zen Zeries - ericooi.com]]
* Zeek Documents
** Zeek logging
*** [[https://docs.zeek.org/en/current/examples/logs/][Logging — Zeek User Manual v3.2.2]]
:PROPERTIES:
:ID:       d546671e-b5ed-435f-83a5-1aac18e26b52
:END:
- [2020-10-14 Wed 23:50] <- [[id:760d9f5c-7444-45b2-b20c-507239ac09ac][Using zeek-cut with logs]]

*** [[https://indico.cern.ch/event/762505/contributions/3375201/attachments/1830709/2998002/2019-04-cern-zeek-logging.pdf][2019-04-cern-zeek-logging.pdf]]
* Zeek-cut
** Using zeek-cut with logs
:PROPERTIES:
:ID:       760d9f5c-7444-45b2-b20c-507239ac09ac
:END:
- [[id:d546671e-b5ed-435f-83a5-1aac18e26b52][Logging — Zeek User Manual v3.2.2]]
* Zeek Performance
** [[https://github.com/mozilla/zept][mozilla/zept: Zeek Extreme Performance Tuning]]
* Zeek Script
** Zeek Script Documents
*** [[https://corelight.blog/2020/09/21/give-me-my-stats/][Give me my stats!]]
** Zeek Script tranning
:PROPERTIES:
:ID:       8f5f972d-f5a3-4eb7-988f-6fdb0c217edb
:END:
*** [[https://github.com/zeek/zeek-training][zeek/zeek-training: Zeek Training Materials/Products]]

** ZeeK Script DNS[3/3]
:PROPERTIES:
:ID:       6b5c4c04-7664-4195-82dd-d333bb63334f
:END:
- [2020-11-20 Fri 21:22] <- [[id:7eae2ec5-aa6b-48b9-a78e-7231b7d3516f][Network Security Project or Idea DNS]]
*** DONE [[https://github.com/hhzzk/dns-tunnels][hhzzk/dns-tunnels]] :DNS:
:PROPERTIES:
:ID:       d233abe0-22a6-4ab4-9bac-8abddfd725ee
:END:
 - [2020-11-20 Fri 21:31] -> [[id:9b5bbd87-bb36-45bd-8e49-ac38c39aa376][detecting-dns-tunneling]]

*** DONE [[https://github.com/srozb/dns_axfr][srozb/dns_axfr: bro dns axfr package]] :DNS:
CLOSED: [2018-12-03 Mon 15:25]
- [[https://en.wikipedia.org/wiki/DNS_zone_transfer][DNS zone transfer - Wikipedia]]
- [[https://cr.yp.to/djbdns/axfr-notes.html][https://cr.yp.to/djbdns/axfr-notes.html]]
*** DONE [[https://github.com/corelight/top-dns][corelight/top-dns: Top DNS Measurement for Bro]]
CLOSED: [2019-08-10 Sat 21:11]

** Zeek Script Conn[3/3]
*** DONE [[https://github.com/corelight/bro-long-connections][corelight/bro-long-connections: Zeek package for tracking long connections to report them before they have completed.]]
CLOSED: [2019-08-10 Sat 21:23]
*** DONE [[https://github.com/corelight/conn-burst][corelight/conn-burst: A Bro package to identify connections that are bursting (lots of data and transferring quickly).]]
CLOSED: [2019-08-10 Sat 21:25]
*** [SMB] https://www.giac.org/paper/gcia/10091/detecting-malicious-smb-activity-bro/140938
*** ✘ CANCELED [Extended TCP Analysis] https://github.com/jswaro/tcprs
CLOSED: [2019-08-10 Sat 21:25]
 [SMBv1] https://github.com/klehigh/find_smbv1

** Zeek Script logging [2/7]
 [filter] https://github.com/hosom/log-filters
 [json]  https://github.com/J-Gras/add-json
 [] https://github.com/corelight/json-streaming-logs
 [liblognorm] https://github.com/J-Gras/bro-lognorm
 [AF_packet] https://github.com/J-Gras/bro-af_packet-plugin

+ [ ] [database
#+begin_src sh :tangle yes
sudo -u postgres psql
sudo -u postgres createuser <username>
 sudo -u postgres createdb <dbname>
createdb -h localhost -p 5432 -U dbuser testdb
psql -h localhost -p 5432 -U dbuser -d testdb
#+end_src

  - [[https://medium.com/coding-blocks/creating-user-database-and-adding-access-on-postgresql-8bfcd2f4a91e][Creating user, database and adding access on PostgreSQL]]


+ [ ] [json-jq] [[https://cameronnokes.com/blog/working-with-json-in-bash-using-jq/][Working with JSON in bash using jq - Cameron Nokes]]

** Zeel Vlan
*** https://github.com/corelight/log-add-vlan-everywhere

** Zeek CVE Detection
*** [[https://github.com/corelight/CVE-2020-16898][GitHub - corelight/CVE-2020-16898: A network detection package for CVE-2020-16898 (Windows TCP/IP Remote Code Execution Vulnerability)]] :windows:

*** [[https://github.com/0xxon/cve-2020-0601][GitHub - 0xxon/cve-2020-0601: Zeek package to detect CVE-2020-0601]]

* Zeek Plugin or analyzer
** DONE [[https://github.com/reservoirlabs/zeek-zip-analyzer][GitHub - reservoirlabs/zeek-zip-analyzer: ZIP analyzer for Zeek]] :analyzer:
** [[https://github.com/zeek/bro-netmap/blob/master/zkg.meta][bro-netmap/zkg.meta at master · zeek/bro-netmap · GitHub]] :packet:

* Zeek Agent
** DONE https://github.com/apache/metron-bro-plugin-kafka :agent:
** DONE [[https://github.com/0xxon/zeek-postgresql/tree/master/scripts][zeek-postgresql/scripts at master · 0xxon/zeek-postgresql]] :agent:

* Zeek Con
** Virtual ZeekWeek
*** day3
- [[https://www.youtube.com/watch?v=9ctRt-vfvns&feature=youtu.be][https://www.youtube.com/watch?v=9ctRt-vfvns&feature=youtu.be]]
